{% extends 'base.html' %}

{% block head %}

{% endblock %}

{% block body %}

{% include 'navbar.html' %}

<div class="flex items-center justify-center min-h-screen bg-gray-100">
  <div class="border border-gray-300 shadow-sm rounded-3xl p-6 max-w-lg w-full bg-white">
      <div class="flex min-h-full flex-col justify-center px-6 py-12 lg:px-8">
          <div class="sm:mx-auto sm:w-full sm:max-w-md">
              <img class="mx-auto h-28 w-auto" src="{{ url_for('static', path='images/logo-tp.png') }}" alt="Your Company">
              <h2 class="mt-5 text-center text-3xl font-bold tracking-tight text-gray-900">Sign up</h2>
          </div>

          <div class="mt-10 sm:mx-auto sm:w-full sm:max-w-md">
              <div id="signup-container" class="space-y-6">

                  <!-- STEP 1: Account Credentials -->
                  <div id="step-1" class="step">

                      <!-- Email -->
                      <div>
                          <label for="email" class="block text-base font-medium text-gray-900">Email address</label>
                          <div class="mt-2">
                              <input type="email" id="email" class="block w-full  rounded-md bg-white px-4 py-2">
                              <p id="email-error" class="text-red-600 text-sm mt-1 hidden">Invalid email format.</p>
                          </div>
                      </div>

                      <!-- Password -->
                      <div class="mt-4">
                          <label for="password" class="block text-base font-medium text-gray-900">Password</label>
                          <div class="mt-2">
                              <input type="password" id="password" class="block w-full  rounded-md bg-white px-4 py-2">
                              <p id="password-error" class="text-red-600 text-sm mt-1 hidden">Password is required.</p>
                          </div>
                      </div>

                      <!-- Confirm Password -->
                      <div class="mt-4">
                          <label for="confirm-password" class="block text-base font-medium text-gray-900">Confirm Password</label>
                          <div class="mt-2">
                              <input type="password" id="confirm-password" class="block w-full  rounded-md bg-white px-4 py-2">
                              <p id="confirm-password-error" class="text-red-600 text-sm mt-1 hidden">Passwords do not match.</p>
                          </div>
                      </div>

                      <button id="next-to-step-2" class="mt-4 w-full bg-sky-800/90 text-white py-2 rounded-md hover:bg-sky-700/90">Next</button>
                  </div>

                  <!-- STEP 2: Personal Details -->
                  <div id="step-2" class="step hidden">

                      <!-- Username -->
                      <div>
                          <label for="username" class="block text-base font-medium text-gray-900">Username</label>
                          <div class="mt-2">
                              <input type="text" id="username" class="block w-full  rounded-md bg-white px-4 py-2">
                              <p id="username-error" class="text-red-600 text-sm mt-1 hidden">Username is required.</p>
                          </div>
                      </div>

                      <!-- Phone (Optional) -->
                      <div class="mt-4">
                          <label for="phone" class="block text-base font-medium text-gray-900">Phone (Optional)</label>
                          <div class="mt-2">
                              <input type="tel" id="phone" class="block w-full  rounded-md bg-white px-4 py-2">
                              <p id="phone-error" class="text-red-600 text-sm mt-1 hidden">Invalid phone number.</p>
                          </div>
                      </div>

                      <!-- Role Selection -->
                      <div class="mt-4">
                          <label for="role" class="block text-base font-medium text-gray-900">Select Role</label>
                          <div class="mt-2">
                              <select id="role" class="block w-full  rounded-md bg-white px-4 py-2">
                                  <option value="user">User</option>
                                  <option value="owner">Restaurant Owner</option>
                              </select>
                          </div>
                      </div>

                      <div class="flex mt-4">
                          <button id="back-to-step-1" class="w-1/2 bg-gray-400 text-white py-2 rounded-md hover:bg-gray-500 mr-2">Back</button>
                          <button id="signup-button" class="w-1/2 bg-sky-800/90 text-white py-2 rounded-md hover:bg-sky-700/90">Sign up</button>
                      </div>

                      <p id="signup-error" class="text-red-600 text-sm mt-3 hidden"></p>
                  </div>
              </div>
              <p class="mt-5 text-center text-base text-gray-500">
                Already have an account?
                <a href="/signin" class="font-semibold text-sky-800/90 hover:text-sky-700/90">Sign in</a>
              </p>
          </div>
      </div>
  </div>
</div>

<script src="{{ url_for('static', path='js/signup.js') }}"></script>
<script type="module" >
  import { signinWithToken } from "{{ url_for('static', path='js/utils.js') }}"
  const redirectUrl = await signinWithToken();
  if (redirectUrl) {
    window.location.href = redirectUrl;
  }
</script>
{% endblock %}